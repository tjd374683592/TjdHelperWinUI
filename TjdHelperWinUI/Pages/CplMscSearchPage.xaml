<Page
    x:Class="TjdHelperWinUI.Pages.CplMscSearchPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:CommunityToolkit.WinUI.UI.Controls"
    xmlns:converters="using:TjdHelperWinUI.Converter"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:TjdHelperWinUI.Pages"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Page.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    </Page.Resources>

    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!--  Cpl DataGrid  -->
        <Grid Grid.Column="0" Margin="0,0,2,0">
            <controls:DataGrid
                x:Name="DgCplResults"
                AutoGenerateColumns="False"
                CanUserResizeColumns="True"
                DoubleTapped="CplResultsGrid_DoubleTapped"
                HeadersVisibility="Column"
                IsReadOnly="True"
                ItemsSource="{Binding CplResults}"
                RightTapped="CplResultsGrid_RightTapped"
                SelectedItem="{Binding SelectedCplItem, Mode=TwoWay}"
                SelectionMode="Single">

                <controls:DataGrid.ContextFlyout>
                    <MenuFlyout>
                        <MenuFlyoutItem
                            Command="{Binding OpenCplDirectoryCommand}"
                            IsEnabled="{Binding SelectedCplItem, Converter={StaticResource BoolToVisibilityConverter}}"
                            Text="打开目录" />

                        <MenuFlyoutSeparator />

                        <MenuFlyoutItem
                            Command="{Binding ExecuteCplCommand}"
                            IsEnabled="{Binding SelectedCplItem, Converter={StaticResource BoolToVisibilityConverter}}"
                            Text="运行" />
                    </MenuFlyout>
                </controls:DataGrid.ContextFlyout>

                <controls:DataGrid.Columns>
                    <controls:DataGridTextColumn
                        Width="60"
                        Binding="{Binding Id}"
                        Header="Id" />
                    <controls:DataGridTextColumn
                        Width="250"
                        Binding="{Binding Name}"
                        Header="Name" />
                    <controls:DataGridTextColumn
                        Width="*"
                        Binding="{Binding Description}"
                        Header="Description" />
                    <controls:DataGridTextColumn
                        Width="*"
                        Binding="{Binding Directory}"
                        Header="Directory" />
                </controls:DataGrid.Columns>
            </controls:DataGrid>

            <!--  CPL  -->
            <ProgressRing
                Width="60"
                Height="60"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                IsActive="{Binding IsSearchingCpl}"
                Visibility="{Binding IsSearchingCpl, Converter={StaticResource BoolToVisibilityConverter}}" />
        </Grid>

        <!--  Msc DataGrid  -->
        <Grid Grid.Column="1" Margin="2,0,0,0">
            <controls:DataGrid
                x:Name="DgMscResults"
                AutoGenerateColumns="False"
                CanUserResizeColumns="True"
                DoubleTapped="MscResultsGrid_DoubleTapped"
                HeadersVisibility="Column"
                IsReadOnly="True"
                ItemsSource="{Binding MscResults}"
                RightTapped="MscResultsGrid_RightTapped"
                SelectedItem="{Binding SelectedMscItem, Mode=TwoWay}"
                SelectionMode="Single">

                <controls:DataGrid.ContextFlyout>
                    <MenuFlyout>
                        <MenuFlyoutItem
                            Command="{Binding OpenMscDirectoryCommand}"
                            IsEnabled="{Binding SelectedMscItem, Converter={StaticResource BoolToVisibilityConverter}}"
                            Text="打开目录" />

                        <MenuFlyoutSeparator />

                        <MenuFlyoutItem
                            Command="{Binding ExecuteMscCommand}"
                            IsEnabled="{Binding SelectedMscItem, Converter={StaticResource BoolToVisibilityConverter}}"
                            Text="运行" />
                    </MenuFlyout>
                </controls:DataGrid.ContextFlyout>

                <controls:DataGrid.Columns>
                    <controls:DataGridTextColumn
                        Width="60"
                        Binding="{Binding Id}"
                        Header="Id" />
                    <controls:DataGridTextColumn
                        Width="250"
                        Binding="{Binding Name}"
                        Header="Name" />
                    <controls:DataGridTextColumn
                        Width="*"
                        Binding="{Binding Description}"
                        Header="Description" />
                    <controls:DataGridTextColumn
                        Width="*"
                        Binding="{Binding Directory}"
                        Header="Directory" />
                </controls:DataGrid.Columns>
            </controls:DataGrid>

            <!--  MSC  -->
            <ProgressRing
                Width="60"
                Height="60"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                IsActive="{Binding IsSearchingMsc}"
                Visibility="{Binding IsSearchingMsc, Converter={StaticResource BoolToVisibilityConverter}}" />
        </Grid>
    </Grid>
</Page>
